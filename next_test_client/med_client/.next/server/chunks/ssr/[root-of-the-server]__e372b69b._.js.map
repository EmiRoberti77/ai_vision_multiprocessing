{"version":3,"sources":["turbopack:///[project]/node_modules/.pnpm/next@15.5.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/src/server/route-modules/app-page/module.compiled.js","turbopack:///[project]/node_modules/.pnpm/next@15.5.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","turbopack:///[project]/node_modules/.pnpm/next@15.5.4_react-dom@19.1.0_react@19.1.0__react@19.1.0/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","turbopack:///[project]/src/app/page.tsx","turbopack:///[project]/src/app/Viewer/viewer.tsx"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","'use client';\n\nimport { useMemo, useState } from 'react';\nimport Viewer from './Viewer/viewer';\n\ntype ApiResponse = {\n  message: string;\n  detections: number;\n  chosen_detection?: { box: [number, number, number, number]; confidence: number; class_id: number };\n  result?: { lot_number: string | null; expiry_date: string | null };\n  artifacts?: { full_frame_path?: string; crop_path?: string; final_path?: string } | null;\n};\n\nexport default function Home() {\n  const [endpoint, setEndpoint] = useState('http://localhost:8000/process?save_artifacts=true');\n  const [data, setData] = useState<ApiResponse | null>(null);\n  const [raw, setRaw] = useState<string>('');\n  const [error, setError] = useState<string>('');\n  const [loading, setLoading] = useState(false);\n  const [lightboxUrl, setLightboxUrl] = useState<string | null>(null);\n\n  // Derive API base (for mapping file-system paths -> HTTP /runs URLs)\n  const apiBase = useMemo(() => {\n    try { const u = new URL(endpoint); return `${u.protocol}//${u.host}`; }\n    catch { return 'http://localhost:8000'; }\n  }, [endpoint]);\n\n  const toRunsUrl = (p?: string | null) => {\n    if (!p) return undefined;\n    const idx = p.lastIndexOf('/runs/');\n    if (idx === -1) return undefined;\n    const sub = p.substring(idx + '/runs/'.length).replaceAll('\\\\', '/');\n    return `${apiBase}/runs/${sub}?t=${Date.now()}`; // cache-bust\n  };\n\n  const handleSubmit = async () => {\n    setLoading(true); setError(''); setData(null); setRaw('');\n    try {\n      const res = await fetch(endpoint, { method: 'POST', headers: { 'Content-Type': 'application/json' } });\n      const json: ApiResponse = await res.json();\n      setData(json);\n      setRaw(JSON.stringify(json, null, 2));\n      if (!res.ok) setError(`HTTP ${res.status}: ${json?.message ?? 'Request failed'}`);\n    } catch (e: any) { setError(e?.message ?? 'Request failed'); }\n    finally { setLoading(false); }\n  };\n\n  const confPct =\n    data?.chosen_detection?.confidence !== undefined\n      ? `${Math.round(data.chosen_detection.confidence * 100)}%`\n      : '—';\n\n  const fullUrl  = toRunsUrl(data?.artifacts?.full_frame_path);\n  const cropUrl  = toRunsUrl(data?.artifacts?.crop_path);\n  const finalUrl = toRunsUrl(data?.artifacts?.final_path);\n\n  return (\n    <div className=\"font-sans h-screen overflow-hidden bg-gray-50 text-gray-900\">\n      {/* Top bar (compact) */}\n      <div className=\"px-3 py-2 flex items-center gap-2 border-b\">\n        <h1 className=\"text-sm font-semibold mr-2\">Medicine OCR Trigger</h1>\n        <input\n          className=\"flex-1 rounded-md border px-2 py-1 text-xs outline-none focus:ring-1 focus:ring-blue-500\"\n          type=\"text\"\n          value={endpoint}\n          onChange={(e) => setEndpoint(e.target.value)}\n          placeholder=\"http://localhost:8000/process?save_artifacts=true\"\n        />\n        <button\n          onClick={handleSubmit}\n          disabled={loading}\n          className=\"rounded-md px-3 py-1 text-xs bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50\"\n        >\n          {loading ? 'Processing…' : 'Submit'}\n        </button>\n      </div>\n\n      {/* Content area: two columns, no vertical scroll */}\n      <main className=\"h-[calc(100vh-40px)] px-3 py-2\">\n        <div className=\"grid grid-cols-12 gap-3 h-full\">\n          {/* LEFT: Player + image strip below */}\n          <div className=\"col-span-7 lg:col-span-8 h-full flex flex-col gap-3\">\n            {/* Player fills available vertical space */}\n            <div className=\"flex-1 rounded-lg border bg-black overflow-hidden\">\n              <Viewer />\n            </div>\n\n            {/* Image strip: single row, proportional spacing, equal widths */}\n            <div className=\"grid grid-cols-3 gap-3 h-32\">\n              {[{ url: fullUrl, label: 'Full' }, { url: cropUrl, label: 'Crop' }, { url: finalUrl, label: 'Final' }].map(\n                ({ url, label }) => (\n                  <button\n                    key={label}\n                    type=\"button\"\n                    onClick={() => url && setLightboxUrl(url)}\n                    className=\"group rounded-lg border bg-white overflow-hidden flex items-center justify-center\"\n                    title={label}\n                  >\n                    {url ? (\n                      <img src={url} alt={label} className=\"w-full h-full object-contain transition-transform group-hover:scale-[1.02]\" />\n                    ) : (\n                      <span className=\"text-[11px] text-gray-500\">{label}: n/a</span>\n                    )}\n                  </button>\n                )\n              )}\n            </div>\n          </div>\n\n          {/* RIGHT: Compact results panel */}\n          <div className=\"col-span-5 lg:col-span-4 rounded-lg border bg-white p-3 text-xs leading-tight overflow-hidden\">\n            {error && (\n              <div className=\"mb-2 rounded-md bg-red-50 border border-red-200 px-2 py-1 text-red-700\">{error}</div>\n            )}\n\n            {data ? (\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"text-[13px] font-medium\">Result</div>\n                  <span className=\"rounded-full bg-gray-100 px-2 py-0.5 text-[11px]\">{data.message}</span>\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <div className=\"rounded-md border p-2\">\n                    <div className=\"text-[11px] text-gray-500\">Detections</div>\n                    <div className=\"text-sm font-semibold\">{data.detections ?? 0}</div>\n                  </div>\n                  <div className=\"rounded-md border p-2\">\n                    <div className=\"text-[11px] text-gray-500\">Confidence</div>\n                    <div className=\"text-sm font-semibold\">{confPct}</div>\n                  </div>\n\n                  <div className=\"rounded-md border p-2 col-span-2\">\n                    <div className=\"text-[11px] text-gray-500\">Box</div>\n                    <div className=\"font-mono text-[11px]\">\n                      {data.chosen_detection?.box ? `[${data.chosen_detection.box.join(', ')}]` : '—'}\n                    </div>\n                  </div>\n\n                  <div className=\"rounded-md border p-2\">\n                    <div className=\"text-[11px] text-gray-500\">Lot</div>\n                    <div className=\"text-sm font-semibold\">{data.result?.lot_number ?? '—'}</div>\n                  </div>\n                  <div className=\"rounded-md border p-2\">\n                    <div className=\"text-[11px] text-gray-500\">Expiry</div>\n                    <div className=\"text-sm font-semibold\">{data.result?.expiry_date ?? '—'}</div>\n                  </div>\n                </div>\n\n                <details className=\"rounded-md border p-2\">\n                  <summary className=\"cursor-pointer select-none text-[11px]\">Raw JSON</summary>\n                  <pre className=\"mt-2 text-[10px] bg-gray-50 p-2 rounded overflow-auto max-h-40\">{raw}</pre>\n                </details>\n              </div>\n            ) : (\n              <div className=\"text-gray-500 text-[12px]\">Run a request to see results.</div>\n            )}\n          </div>\n        </div>\n      </main>\n\n      {/* Fullscreen lightbox */}\n      {lightboxUrl && (\n        <button\n          type=\"button\"\n          onClick={() => setLightboxUrl(null)}\n          className=\"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4\"\n          title=\"Close\"\n        >\n          <img\n            src={lightboxUrl}\n            alt=\"Preview\"\n            className=\"max-w-[95vw] max-h-[95vh] object-contain rounded-lg shadow-2xl\"\n          />\n        </button>\n      )}\n    </div>\n  );\n}\n","'use client';\nimport { useState } from 'react';\n\nexport default function Viewer() {\n  const [src, setSrc] = useState('http://localhost:8000/stream/mjpg?fps=15&quality=80');\n  const [server, setServer] = useState(\"OAIX_MEDIA_SERVER V.1.0\");\n\n  return (\n    <div className=\"p-6 space-y-4\">\n      <h1 className=\"text-xl font-semibold\">Live RTSP</h1>\n\n      <div className=\"flex gap-2\">\n        <input\n          className=\"flex-1 rounded border px-3 py-2\"\n          value={server}\n          onChange={(e) => setSrc(e.target.value)}\n        />\n      </div>\n\n      <div className=\"rounded-xl overflow-hidden border bg-black max-w-[960px]\">\n        <img src={src} alt=\"Live stream\" className=\"w-full h-auto\" />\n      </div>\n    </div>\n  );\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","ReactJsxRuntime","React"],"mappings":"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","ignoreList":[0,1,2]}