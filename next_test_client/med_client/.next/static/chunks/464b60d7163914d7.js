(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";e.s(["default",()=>a],52683);var s=e.i(78196),l=e.i(49430);function t(){let[e,t]=(0,l.useState)("http://localhost:8000/stream/mjpg?fps=15&quality=80"),[a,n]=(0,l.useState)("OAIX_MEDIA_SERVER V.1.0");return(0,s.jsxs)("div",{className:"p-6 space-y-4",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold",children:"Live RTSP"}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsx)("input",{className:"flex-1 rounded border px-3 py-2",value:a,onChange:e=>t(e.target.value)})}),(0,s.jsx)("div",{className:"rounded-xl overflow-hidden border bg-black max-w-[960px]",children:(0,s.jsx)("img",{src:e,alt:"Live stream",className:"w-full h-auto"})})]})}function a(){var e,a,n,r,d,c,i,o,x,u;let[m,h]=(0,l.useState)("http://localhost:8000/process?save_artifacts=true"),[p,v]=(0,l.useState)(null),[g,f]=(0,l.useState)(""),[b,j]=(0,l.useState)(""),[N,y]=(0,l.useState)(!1),[w,S]=(0,l.useState)(null),_=(0,l.useMemo)(()=>{try{let e=new URL(m);return"".concat(e.protocol,"//").concat(e.host)}catch(e){return"http://localhost:8000"}},[m]),C=e=>{if(!e)return;let s=e.lastIndexOf("/runs/");if(-1===s)return;let l=e.substring(s+6).replaceAll("\\","/");return"".concat(_,"/runs/").concat(l,"?t=").concat(Date.now())},R=async()=>{var e,s;y(!0),j(""),v(null),f("");try{let s=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"}}),l=await s.json();v(l),f(JSON.stringify(l,null,2)),s.ok||j("HTTP ".concat(s.status,": ").concat(null!=(e=null==l?void 0:l.message)?e:"Request failed"))}catch(e){j(null!=(s=null==e?void 0:e.message)?s:"Request failed")}finally{y(!1)}},T=(null==p||null==(e=p.chosen_detection)?void 0:e.confidence)!==void 0?"".concat(Math.round(100*p.chosen_detection.confidence),"%"):"—",O=C(null==p||null==(a=p.artifacts)?void 0:a.full_frame_path),k=C(null==p||null==(n=p.artifacts)?void 0:n.crop_path),P=C(null==p||null==(r=p.artifacts)?void 0:r.final_path);return(0,s.jsxs)("div",{className:"font-sans h-screen overflow-hidden bg-gray-50 text-gray-900",children:[(0,s.jsxs)("div",{className:"px-3 py-2 flex items-center gap-2 border-b",children:[(0,s.jsx)("h1",{className:"text-sm font-semibold mr-2",children:"Medicine OCR Trigger"}),(0,s.jsx)("input",{className:"flex-1 rounded-md border px-2 py-1 text-xs outline-none focus:ring-1 focus:ring-blue-500",type:"text",value:m,onChange:e=>h(e.target.value),placeholder:"http://localhost:8000/process?save_artifacts=true"}),(0,s.jsx)("button",{onClick:R,disabled:N,className:"rounded-md px-3 py-1 text-xs bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:N?"Processing…":"Submit"})]}),(0,s.jsx)("main",{className:"h-[calc(100vh-40px)] px-3 py-2",children:(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-3 h-full",children:[(0,s.jsxs)("div",{className:"col-span-7 lg:col-span-8 h-full flex flex-col gap-3",children:[(0,s.jsx)("div",{className:"flex-1 rounded-lg border bg-black overflow-hidden",children:(0,s.jsx)(t,{})}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-3 h-32",children:[{url:O,label:"Full"},{url:k,label:"Crop"},{url:P,label:"Final"}].map(e=>{let{url:l,label:t}=e;return(0,s.jsx)("button",{type:"button",onClick:()=>l&&S(l),className:"group rounded-lg border bg-white overflow-hidden flex items-center justify-center",title:t,children:l?(0,s.jsx)("img",{src:l,alt:t,className:"w-full h-full object-contain transition-transform group-hover:scale-[1.02]"}):(0,s.jsxs)("span",{className:"text-[11px] text-gray-500",children:[t,": n/a"]})},t)})})]}),(0,s.jsxs)("div",{className:"col-span-5 lg:col-span-4 rounded-lg border bg-white p-3 text-xs leading-tight overflow-hidden",children:[b&&(0,s.jsx)("div",{className:"mb-2 rounded-md bg-red-50 border border-red-200 px-2 py-1 text-red-700",children:b}),p?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-[13px] font-medium",children:"Result"}),(0,s.jsx)("span",{className:"rounded-full bg-gray-100 px-2 py-0.5 text-[11px]",children:p.message})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"rounded-md border p-2",children:[(0,s.jsx)("div",{className:"text-[11px] text-gray-500",children:"Detections"}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:null!=(o=p.detections)?o:0})]}),(0,s.jsxs)("div",{className:"rounded-md border p-2",children:[(0,s.jsx)("div",{className:"text-[11px] text-gray-500",children:"Confidence"}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:T})]}),(0,s.jsxs)("div",{className:"rounded-md border p-2 col-span-2",children:[(0,s.jsx)("div",{className:"text-[11px] text-gray-500",children:"Box"}),(0,s.jsx)("div",{className:"font-mono text-[11px]",children:(null==(d=p.chosen_detection)?void 0:d.box)?"[".concat(p.chosen_detection.box.join(", "),"]"):"—"})]}),(0,s.jsxs)("div",{className:"rounded-md border p-2",children:[(0,s.jsx)("div",{className:"text-[11px] text-gray-500",children:"Lot"}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:null!=(x=null==(c=p.result)?void 0:c.lot_number)?x:"—"})]}),(0,s.jsxs)("div",{className:"rounded-md border p-2",children:[(0,s.jsx)("div",{className:"text-[11px] text-gray-500",children:"Expiry"}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:null!=(u=null==(i=p.result)?void 0:i.expiry_date)?u:"—"})]})]}),(0,s.jsxs)("details",{className:"rounded-md border p-2",children:[(0,s.jsx)("summary",{className:"cursor-pointer select-none text-[11px]",children:"Raw JSON"}),(0,s.jsx)("pre",{className:"mt-2 text-[10px] bg-gray-50 p-2 rounded overflow-auto max-h-40",children:g})]})]}):(0,s.jsx)("div",{className:"text-gray-500 text-[12px]",children:"Run a request to see results."})]})]})}),w&&(0,s.jsx)("button",{type:"button",onClick:()=>S(null),className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4",title:"Close",children:(0,s.jsx)("img",{src:w,alt:"Preview",className:"max-w-[95vw] max-h-[95vh] object-contain rounded-lg shadow-2xl"})})]})}}]);