(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";e.s(["default",()=>a],52683);var s=e.i(43476),l=e.i(71645);function t(){let[e]=(0,l.useState)("http://localhost:8000/stream/mjpg?fps=15&quality=80");return(0,s.jsxs)("div",{className:"relative w-full h-full rounded-md border overflow-hidden bg-black",children:[(0,s.jsx)("img",{src:e,alt:"Live stream",className:"absolute inset-0 block w-full h-full object-contain select-none"}),(0,s.jsx)("div",{className:"absolute top-2 left-2 z-20 px-2 py-1 rounded bg-black/65 text-white text-[11px]",children:"OAIX_MEDIA_SERVER v1.0"})]})}function a(){var e,a,n,r,c,i,d,o,x,u,m,h;let[p,f]=(0,l.useState)("http://localhost:8000/process?save_artifacts=true"),[b,v]=(0,l.useState)(null),[j,g]=(0,l.useState)(""),[N,y]=(0,l.useState)(""),[_,w]=(0,l.useState)(!1),[S,k]=(0,l.useState)(null),C=(0,l.useMemo)(()=>{try{let e=new URL(p);return"".concat(e.protocol,"//").concat(e.host)}catch(e){return"http://localhost:8000"}},[p]),R=e=>{if(!e)return;let s=e.lastIndexOf("/runs/");if(-1===s)return;let l=e.substring(s+6).replaceAll("\\","/");return"".concat(C,"/runs/").concat(l,"?t=").concat(Date.now())},O=async()=>{var e,s;w(!0),y(""),v(null),g("");try{let s=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"}}),l=await s.json();v(l),g(JSON.stringify(l,null,2)),s.ok||y("HTTP ".concat(s.status,": ").concat(null!=(e=null==l?void 0:l.message)?e:"Request failed"))}catch(e){y(null!=(s=null==e?void 0:e.message)?s:"Request failed")}finally{w(!1)}},T=R(null==b||null==(e=b.artifacts)?void 0:e.full_frame_path),P=R(null==b||null==(a=b.artifacts)?void 0:a.crop_path),A=R(null==b||null==(n=b.artifacts)?void 0:n.final_path);return(0,s.jsxs)("div",{className:"font-sans min-h-screen bg-gray-50 text-gray-900",children:[(0,s.jsxs)("div",{className:"h-10 px-2 py-1 flex items-center gap-2 border-b sticky top-0 bg-gray-50 z-10",children:[(0,s.jsx)("h1",{className:"text-[12px] font-semibold mr-2",children:"Medicine OCR"}),(0,s.jsx)("input",{className:"flex-1 rounded-md border px-2 py-1 text-[11px] outline-none focus:ring-1 focus:ring-blue-500",value:p,onChange:e=>f(e.target.value),placeholder:"http://localhost:8000/process?save_artifacts=true"}),(0,s.jsx)("button",{onClick:O,disabled:_,className:"rounded-md px-3 py-1 text-[11px] bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:_?"Processing…":"Submit"})]}),(0,s.jsx)("main",{className:"px-2 py-2",children:(0,s.jsxs)("div",{className:"grid grid-cols-12 gap-3",children:[(0,s.jsx)("div",{className:"col-span-8 lg:col-span-9",children:(0,s.jsxs)("div",{className:"grid gap-2 h-[110vh] grid-rows-[50%_50%]",children:[(0,s.jsx)(t,{}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2 h-full",children:[{url:T,label:"Full"},{url:P,label:"Crop"},{url:A,label:"Final"}].map(e=>{let{url:l,label:t}=e;return(0,s.jsx)("button",{type:"button",onClick:()=>l&&k(l),className:"group h-full w-full",title:t,children:(0,s.jsx)("div",{className:"h-full w-full rounded-md border overflow-hidden bg-black",children:l?(0,s.jsx)("img",{src:l,alt:t,className:"block w-full h-full object-contain transition-transform group-hover:scale-[1.01]"}):(0,s.jsxs)("span",{className:"flex items-center justify-center w-full h-full text-[11px] text-gray-400",children:[t,": n/a"]})})},t)})})]})}),(0,s.jsxs)("div",{className:"col-span-4 lg:col-span-3 rounded-md border bg-white p-2 text-[11px] leading-tight max-h-[110vh] overflow-auto",children:[N&&(0,s.jsx)("div",{className:"mb-2 rounded-md bg-red-50 border border-red-200 px-2 py-1 text-red-700",children:N}),b?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-[12px] font-medium",children:"Result"}),(0,s.jsx)("span",{className:"rounded-full bg-gray-100 px-2 py-[2px] text-[10px]",children:b.message})]}),(0,s.jsxs)("section",{className:"rounded-md border p-2 space-y-2",children:[(0,s.jsx)("div",{className:"text-[11px] font-medium",children:"Predictions"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"rounded border p-2",children:[(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Detections"}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:null!=(x=b.detections)?x:0})]}),(0,s.jsxs)("div",{className:"rounded border p-2",children:[(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Confidence"}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:(null==b||null==(r=b.chosen_detection)?void 0:r.confidence)!==void 0?"".concat(Math.round(100*b.chosen_detection.confidence),"%"):"—"})]}),(0,s.jsxs)("div",{className:"rounded border p-2",children:[(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Class ID"}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:null!=(u=null==b||null==(c=b.chosen_detection)?void 0:c.class_id)?u:"—"})]}),(0,s.jsxs)("div",{className:"rounded border p-2 col-span-2",children:[(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Box"}),(0,s.jsx)("div",{className:"font-mono text-[10px]",children:(null==b||null==(i=b.chosen_detection)?void 0:i.box)?"[".concat(b.chosen_detection.box.join(", "),"]"):"—"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"rounded border p-2",children:[(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Lot"}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:null!=(m=null==b||null==(d=b.result)?void 0:d.lot_number)?m:"—"})]}),(0,s.jsxs)("div",{className:"rounded border p-2",children:[(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Expiry"}),(0,s.jsx)("div",{className:"text-sm font-semibold",children:null!=(h=null==b||null==(o=b.result)?void 0:o.expiry_date)?h:"—"})]})]})]}),b.artifacts&&(0,s.jsxs)("section",{className:"rounded-md border p-2 space-y-1",children:[(0,s.jsx)("div",{className:"text-[11px] font-medium",children:"Artifacts"}),(0,s.jsxs)("ul",{className:"list-disc ml-4 font-mono text-[10px] break-all space-y-[2px]",children:[b.artifacts.full_frame_path&&(0,s.jsxs)("li",{children:["full: ",b.artifacts.full_frame_path]}),b.artifacts.crop_path&&(0,s.jsxs)("li",{children:["crop: ",b.artifacts.crop_path]}),b.artifacts.final_path&&(0,s.jsxs)("li",{children:["final: ",b.artifacts.final_path]})]})]}),(0,s.jsxs)("details",{className:"rounded-md border p-2",children:[(0,s.jsx)("summary",{className:"cursor-pointer select-none text-[10px]",children:"Raw JSON"}),(0,s.jsx)("pre",{className:"mt-2 text-[10px] bg-gray-50 p-2 rounded overflow-auto max-h-60",children:JSON.stringify(b,null,2)})]})]}):(0,s.jsx)("div",{className:"text-gray-500 text-[12px]",children:"Run a request to see results."})]})]})}),S&&(0,s.jsx)("button",{type:"button",onClick:()=>k(null),className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4",title:"Close",children:(0,s.jsx)("img",{src:S,alt:"Preview",className:"max-w-[95vw] max-h-[95vh] object-contain rounded-md shadow-2xl"})})]})}}]);